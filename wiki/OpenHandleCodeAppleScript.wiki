#summary AppleScript ocde examples for OpenHandle

[OpenHandleCodeExamples Code Examples]
== OpenHandle Apple**Script Code Examples ==

Here's how a native Apple**Script program (contained in file "`handler.scpt`") can grab a handle data record:

{{{
% cat handler.scpt
(*
    AppleScript to get OpenHandle Result
*)

property openhandle : "http://nascent.nature.com/openhandle/handle"
property default_handle : "10100/nature"

on run argv
	try
		-- run interactively with "Script Editor"
		set result to display dialog "Enter handle" default answer default_handle
		set handle to text returned of result
	on error
		-- run in batch mode with "osascript"
		try
			set handle to item 1 of argv
		on error
			set handle to default_handle
		end try
	end try
	getHandle(handle)
end run

on getHandle(handle)
	
	set the_url to openhandle & "?id=" & handle & "&format=json"
	set json to do shell script "curl " & quoted form of the_url
	
	tell application "TextEdit"
		activate
		make new document at the front
		set text of the front document to json
	end tell
	
end getHandle
}}}

And this can be run as:
{{{
% osascript handler.scpt <handle>
}}}

or can be run interactively which gives:
{{{
% open handler.scpt
}}}


|| http://nurture.nature.com/tony/imx/openhandle_scpt.jpg || http://nurture.nature.com/tony/imx/openhandle_textedit_scpt.jpg ||