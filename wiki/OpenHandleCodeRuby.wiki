#summary Ruby code examples for OpenHandle

[OpenHandleCodeExamples Code Examples]
== OpenHandle Ruby Code Examples ==

It is expected that there could be an OpenHandle Ruby library but in the meantime OpenHandle can be accessed straightforwardly from native Ruby code.

Here's how a native Ruby program (contained in file "`handler.rb`") can grab a handle data record:

{{{
% cat handler.rb
require 'rubygems'    # only if "json" lib installed as gem
require 'json'
require 'open-uri'

OPENHANDLE = "http://nascent.nature.com/openhandle/handle"

uri = URI.parse("#{OPENHANDLE}?id=#{ARGV[0]}&format=json")

p JSON.parse(uri.open.read)
}}}

which can be run as

{{{
% ruby handler.rb 10.1038/nature05392
{"handle"=>"hdl:10.1038/nature05932", "comment"=>"OpenHandle (JSON) - see
http://openhandle.googlecode.com/", "handleValues"=>[{"reference"=>[],
"timestamp"=>"Wed Jun 20 18:14:42 BST 2007", "ttl"=>"+86400",
"permission"=>"1110", "type"=>"URL", "index"=>"1",
"data"=>"http://www.nature.com/doifinder/10.1038/nature05932"},
{"reference"=>[], "timestamp"=>"Wed Jul 11 20:40:04 BST 2007", "ttl"=>"+86400",
"permission"=>"1110", "type"=>"700050", "index"=>"2", "data"=>"20070711131808"},
{"reference"=>[], "timestamp"=>"Wed Jun 20 18:14:42 BST 2007", "ttl"=>"+86400",
"permission"=>"1110", "type"=>"HS_ADMIN", "index"=>"100",
"data"=>{"adminPermission"=>"101110101111",
"adminRef"=>"hdl:10.1038/nature05932?index=100"}}]}

Or, as an attempt at pretty printing we might turn this back into JSON *from* the instantiated Ruby data structure using `JSON.pretty_generate`. (I can't seem to find a suitable Ruby pretty printing method to give me back a prettified literal notation.)
{{{
% cat handler.rb
require 'rubygems'   # only if "json" lib installed as gem
require 'json'
require 'open-uri'

OPENHANDLE = "http://nascent.nature.com/openhandle/handle"

uri = URI.parse("#{OPENHANDLE}?id=#{ARGV[0]}&format=json")

h = JSON.parse(uri.open.read)
puts JSON.pretty_generate(h)
}}}

 
{{{
% ruby handler.rb 10.1038/nature05932
{
  "handle": "hdl:10.1038\/nature05932",
  "comment": "OpenHandle (JSON) - see http:\/\/openhandle.googlecode.com\/",
  "handleValues": [
    {
      "reference": [

      ],
      "timestamp": "Wed Jun 20 18:14:42 BST 2007",
      "ttl": "+86400",
      "permission": "1110",
      "type": "URL",
      "index": "1",
      "data": "http:\/\/www.nature.com\/doifinder\/10.1038\/nature05932"
    },
    {
      "reference": [

      ],
      "timestamp": "Wed Jul 11 20:40:04 BST 2007",
      "ttl": "+86400",
      "permission": "1110",
      "type": "700050",
      "index": "2",
      "data": "20070711131808"
    },
    {
      "reference": [

      ],
      "timestamp": "Wed Jun 20 18:14:42 BST 2007",
      "ttl": "+86400",
      "permission": "1110",
      "type": "HS_ADMIN",
      "index": "100",
      "data": {
        "adminPermission": "101110101111",
        "adminRef": "hdl:10.1038\/nature05932?index=100"
      }
    }
  ]
}
}}}