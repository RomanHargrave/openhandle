#summary Ruby code examples for OpenHandle

[OpenHandleCodeExamples Code Examples]
== OpenHandle Ruby Code Examples ==

It is expected that there could be an OpenHandle Ruby library but in the meantime OpenHandle can be accessed straightforwardly from native Ruby code.

Here's how a native Ruby program (contained in file "[http://nurture.nature.com/tony/openhandle/code/ruby/handler.rb handler.rb]") can grab a handle data record:

{{{
% cat handler.rb
require 'rubygems'    # only if "json" lib installed as gem
require 'json'
require 'open-uri'

OPENHANDLE = "http://nascent.nature.com/openhandle/handle"

uri = URI.parse("#{OPENHANDLE}?id=#{ARGV[0]}&format=json")
json = uri.open.read

h = JSON.parse(json)

values = h['handleValues']
s = "The handle <#{h['handle']}>"
s += " has #{values.length} values:\n"

1.upto(values.length) do |n|

  value = values[n-1]

  s += "\nvalue \##{n}:\n"
  s += "  index = #{value['index']}\n"
  s += "  type = #{value['type']}\n"
  if value['data'].class == String
    s += "  data = #{value['data']}\n"
  else
    s += "  data = [#{value['data'].class}]\n"
  end
  s += "  permission = #{value['permission']}\n"
  s += "  ttl = #{value['ttl'].to_i / 3600} hours\n"
  s += "  timestamp = #{value['timestamp']}\n"
  s += "  reference = [#{value['reference'].class}]\n"

end
puts s
}}}

This can be run as:
{{{
% ruby handler.rb 10100/nature
The handle <hdl:10100/nature> has 2 values:

value #1:
  index = 100
  type = HS_ADMIN
  data = [Hash]
  permission = 1110
  ttl = 24 hours
  timestamp = Wed Feb 28 15:37:06 GMT 2007
  reference = [Array]

value #2:
  index = 1
  type = URL
  data = http://www.nature.com/
  permission = 1110
  ttl = 24 hours
  timestamp = Wed Feb 28 15:37:06 GMT 2007
  reference = [Array]
}}}